spring:
  application:
    name: backend
  datasource:
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: validate
    open-in-view: false
  data:
    redis:
      host: ${SPRING_REDIS_HOST}
      port: ${SPRING_REDIS_PORT}
  rabbitmq:
    host: ${SPRING_RABBITMQ_HOST}
    port: ${SPRING_RABBITMQ_PORT}
    username: ${SPRING_RABBITMQ_USERNAME}
    password: ${SPRING_RABBITMQ_PASSWORD}
  mail:
    host: ${SPRING_MAIL_HOST}
    port: ${SPRING_MAIL_PORT}
    username: ${SPRING_MAIL_USERNAME:}
    password: ${SPRING_MAIL_PASSWORD:}
    properties:
      mail.smtp.auth: false
      mail.smtp.starttls.enable: false
  servlet:
    multipart:
      max-file-size: 50MB
      max-request-size: 200MB

server:
  port: ${PORT:8080}

springdoc:
  api-docs:
    path: /openapi
  swagger-ui:
    enabled: false
  paths-to-exclude:
    - /docs
    - /docs/**

scalar:
  enabled: false
  path: /docs
  url: /openapi/mobile

auth:
  cookie:
    name: sid
    secure: false
    same-site: Lax
    path: /
  refresh-cookie:
    name: rid
    secure: false
    same-site: Lax
    path: /
  session:
    ttl: PT15M
  refresh:
    ttl: PT168H
  verification:
    ttl: PT15M
    expose-token-in-response: ${AUTH_VERIFICATION_EXPOSE_TOKEN_IN_RESPONSE:true}
    resend-cooldown: ${AUTH_VERIFICATION_RESEND_COOLDOWN:PT1M}
  cache:
    prefix: auth
    user-session-set-prefix: auth:user-sessions
  mail:
    from: ${AUTH_MAIL_FROM:no-reply@starterpack.local}
    verification-link-base-url: ${AUTH_MAIL_VERIFICATION_LINK_BASE_URL:http://localhost:3000/verify}
    password-reset-link-base-url: ${AUTH_MAIL_PASSWORD_RESET_LINK_BASE_URL:http://localhost:3000/reset-password}

cache:
  users:
    list-ttl: PT5M

upload:
  max-file-size-bytes: 52428800
  allowed-content-types: []
  local:
    base-dir: uploads
    public-base-url: /files

rate-limit:
  enabled: ${RATE_LIMIT_ENABLED:true}
  prefix: ${RATE_LIMIT_PREFIX:rl}
  policies:
    auth-login:
      window: ${RATE_LIMIT_AUTH_LOGIN_WINDOW:PT1M}
      max-requests: ${RATE_LIMIT_AUTH_LOGIN_MAX_REQUESTS:5}
      block-duration: ${RATE_LIMIT_AUTH_LOGIN_BLOCK_DURATION:PT10M}
      keys: [ip, route]
    auth-register:
      window: ${RATE_LIMIT_AUTH_REGISTER_WINDOW:PT10M}
      max-requests: ${RATE_LIMIT_AUTH_REGISTER_MAX_REQUESTS:5}
      block-duration: ${RATE_LIMIT_AUTH_REGISTER_BLOCK_DURATION:PT30M}
      keys: [ip, route]
    auth-refresh:
      window: ${RATE_LIMIT_AUTH_REFRESH_WINDOW:PT1M}
      max-requests: ${RATE_LIMIT_AUTH_REFRESH_MAX_REQUESTS:20}
      block-duration: ${RATE_LIMIT_AUTH_REFRESH_BLOCK_DURATION:PT5M}
      keys: [ip, route]
    auth-verify-request:
      window: ${RATE_LIMIT_AUTH_VERIFY_REQUEST_WINDOW:PT15M}
      max-requests: ${RATE_LIMIT_AUTH_VERIFY_REQUEST_MAX_REQUESTS:3}
      block-duration: ${RATE_LIMIT_AUTH_VERIFY_REQUEST_BLOCK_DURATION:PT30M}
      keys: [userId, route]
    auth-verify-resend:
      window: ${RATE_LIMIT_AUTH_VERIFY_RESEND_WINDOW:PT15M}
      max-requests: ${RATE_LIMIT_AUTH_VERIFY_RESEND_MAX_REQUESTS:3}
      block-duration: ${RATE_LIMIT_AUTH_VERIFY_RESEND_BLOCK_DURATION:PT30M}
      keys: [userId, route]
    auth-password-forgot:
      window: ${RATE_LIMIT_AUTH_PASSWORD_FORGOT_WINDOW:PT15M}
      max-requests: ${RATE_LIMIT_AUTH_PASSWORD_FORGOT_MAX_REQUESTS:5}
      block-duration: ${RATE_LIMIT_AUTH_PASSWORD_FORGOT_BLOCK_DURATION:PT30M}
      keys: [ip, route]
    auth-password-reset:
      window: ${RATE_LIMIT_AUTH_PASSWORD_RESET_WINDOW:PT15M}
      max-requests: ${RATE_LIMIT_AUTH_PASSWORD_RESET_MAX_REQUESTS:10}
      block-duration: ${RATE_LIMIT_AUTH_PASSWORD_RESET_BLOCK_DURATION:PT30M}
      keys: [ip, route]
    auth-reauth:
      window: ${RATE_LIMIT_AUTH_REAUTH_WINDOW:PT1M}
      max-requests: ${RATE_LIMIT_AUTH_REAUTH_MAX_REQUESTS:10}
      block-duration: ${RATE_LIMIT_AUTH_REAUTH_BLOCK_DURATION:PT5M}
      keys: [userId, route]
    auth-account-delete-request:
      window: ${RATE_LIMIT_AUTH_ACCOUNT_DELETE_REQUEST_WINDOW:PT1H}
      max-requests: ${RATE_LIMIT_AUTH_ACCOUNT_DELETE_REQUEST_MAX_REQUESTS:3}
      block-duration: ${RATE_LIMIT_AUTH_ACCOUNT_DELETE_REQUEST_BLOCK_DURATION:PT2H}
      keys: [userId, route]
    auth-account-delete-confirm:
      window: ${RATE_LIMIT_AUTH_ACCOUNT_DELETE_CONFIRM_WINDOW:PT15M}
      max-requests: ${RATE_LIMIT_AUTH_ACCOUNT_DELETE_CONFIRM_MAX_REQUESTS:5}
      block-duration: ${RATE_LIMIT_AUTH_ACCOUNT_DELETE_CONFIRM_BLOCK_DURATION:PT1H}
      keys: [userId, route]
